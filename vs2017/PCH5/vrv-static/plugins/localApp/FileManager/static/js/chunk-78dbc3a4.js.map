{"version":3,"sources":["webpack:///./src/components/Contact/index.vue?b367","webpack:///src/components/Contact/index.vue","webpack:///./src/components/Contact/index.vue?f81b","webpack:///./src/components/Contact/index.vue","webpack:///./src/components/Contact/index.vue?88ec"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_l","contactsList","slice","initLength","contactsInfo","index","key","attrs","thumbAvatar","_v","_s","name","isSelected","id","on","$event","selectContact","staticRenderFns","mixins","props","data","selectedMembers","mounted","console","log","members_range","$Service","contact","getContactList","$nextTick","cardBody","addEventListener","e","stopPropagation","Object","assign","returnPageValue","$emit","computed","searchInfo","trim","methods","loadMoreData","hasOwnProperty","value","$delete","$set","memberObj","membersKeys","includes","keys","component"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,YAAYN,EAAIO,GAAIP,EAAIQ,aAAaC,MAAM,EAAGT,EAAIU,aAAa,SAASC,EAAaC,GAAO,OAAOR,EAAG,MAAM,CAACS,IAAID,EAAMN,YAAY,iBAAiB,CAACF,EAAG,WAAW,CAACE,YAAY,SAASQ,MAAM,CAAC,KAAO,KAAK,IAAMH,EAAaI,eAAeX,EAAG,OAAO,CAACE,YAAY,iBAAiB,CAACN,EAAIgB,GAAGhB,EAAIiB,GAAGN,EAAaO,SAASd,EAAG,aAAa,CAACE,YAAY,iBAAiBQ,MAAM,CAAC,KAAO,SAAS,MAAQd,EAAImB,WAAWR,EAAaS,KAAKC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOtB,EAAIuB,cAAcZ,QAAmB,MAAK,IACzmBa,EAAkB,G,+rBCetB,OACEN,KAAM,eACNO,OAAQ,CAAC,EAAX,MACEC,MAAO,CACT,gCAEEC,KANF,WAOI,MAAO,CACLjB,WAAY,GACZkB,gBAAiB,KAGrBC,QAZF,WAYA,WACIC,QAAQC,IAAI,oBAAhB,oBACID,QAAQC,IAAI,wBAAyB9B,KAAK+B,eAC1C/B,KAAKgC,SAASC,QAAQC,eAAe,MAAM,SAA/C,GACM,EAAN,4CACM,EAAN,iEAEIlC,KAAKmC,WAAU,WACb,IAAN,sCACMC,EAASC,iBAAiB,UAAU,SAA1C,GACQC,EAAEC,kBACF,EAAR,sBAIA,iDAEMvC,KAAK2B,gBAAkBa,OAAOC,OAAO,GAAIzC,KAAK0C,gBAAgBT,SAC9DjC,KAAK2C,MAAM,gBAAiB,CAAlC,iCAGEC,SAAU,EAAZ,GACA,iDADA,CAEIrC,aAFJ,WAEA,WAEM,OADAsB,QAAQC,IAAI,QAAlB,mBACqC,KAA3B9B,KAAK6C,WAAWC,OACX,EAAf,UACA,0CAAU,OAAV,oCACA,YACU,OAAV,kCAEA,SAGa,EAAb,qFAGEC,QAAS,CAEPC,aAFJ,SAEA,cACMhD,KAAKmC,WAAU,WACT,EAAZ,qBACc,EAAd,mCACYN,QAAQC,IAAI,UACR,EAAhB,qCACc,EAAd,iCACcD,QAAQC,IAAI,aAEZ,EAAd,eACcD,QAAQC,IAAI,iBAMtBR,cAlBJ,SAkBA,GACUtB,KAAK2B,gBAAgBsB,eAAeC,EAAM/B,IAE5CnB,KAAKmD,QAAQnD,KAAK2B,gBAAiBuB,EAAM/B,IAEzCnB,KAAKoD,KAAKpD,KAAK2B,gBAAiBuB,EAAM/B,GAAI+B,GAE5CrB,QAAQC,IAAI,wBAAyB9B,KAAK2B,iBAC1C,IAAN,GACQ,QAAW3B,KAAK2B,iBAElB3B,KAAK2C,MAAM,gBAAiBU,IAE9BnC,WA/BJ,SA+BA,GAEM,GADAW,QAAQC,IAAI,UAAlB,8BACU9B,KAAK0C,gBAAgBO,eAAe,WAAY,CAClD,IAAR,4CAEQ,OADApB,QAAQC,IAAI,cAApB,GACewB,EAAYC,SAASpC,GAE9B,IAAN,8BACQU,QAAQC,IAAI,UAApB,GACQD,QAAQC,IAAIU,OAAOgB,KAAKxD,KAAK2B,kBAC7B,IAAR,oCACQ,OAAO,EAAf,gBC3G8V,I,wBCQ1V8B,EAAY,eACd,EACA3D,EACAyB,GACA,EACA,KACA,WACA,MAIa,aAAAkC,E,6CCnBf,yBAAojB,EAAG,G","file":"static/js/chunk-78dbc3a4.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"contacts\"},_vm._l((_vm.contactsList.slice(0, _vm.initLength)),function(contactsInfo,index){return _c('div',{key:index,staticClass:\"contacts-item\"},[_c('d-avatar',{staticClass:\"avatar\",attrs:{\"size\":\"30\",\"src\":contactsInfo.thumbAvatar}}),_c('span',{staticClass:\"contacts-name\"},[_vm._v(_vm._s(contactsInfo.name))]),_c('d-checkbox',{staticClass:\"checkbox-right\",attrs:{\"size\":\"medium\",\"value\":_vm.isSelected(contactsInfo.id)},on:{\"input\":function($event){return _vm.selectContact(contactsInfo)}}})],1)}),0)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!-- 联系人列表 -->\r\n<template>\r\n  <div class=\"contacts\">\r\n    <div v-for=\"(contactsInfo,index) in contactsList.slice(0, initLength)\" :key=\"index\" class=\"contacts-item\"> \r\n      <d-avatar class=\"avatar\" size=\"30\" :src=\"contactsInfo.thumbAvatar\"></d-avatar>\r\n      <span class=\"contacts-name\">{{contactsInfo.name}}</span>\r\n      <d-checkbox size=\"medium\" class=\"checkbox-right\" @input=\"selectContact(contactsInfo)\" :value='isSelected(contactsInfo.id)'></d-checkbox>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport _  from 'lodash';\r\nimport { mapGetters } from 'vuex';\r\nimport FileListMixin from '../File/FileList';\r\nimport { converseFullPinYin } from 'utils/pinyin.js'\r\nexport default {\r\n  name: 'contact-list',\r\n  mixins: [ FileListMixin ],\r\n  props: [\r\n    'searchInfo','returnPageValue'\r\n  ],\r\n  data() {\r\n    return {\r\n      initLength: 10,\r\n      selectedMembers: {}\r\n    }\r\n  },\r\n  mounted() {\r\n    console.log('this.contactsList',this.contactsInfos);\r\n    console.log('vuex info for contact', this.members_range);\r\n    this.$Service.contact.getContactList(null, resp => {\r\n      this.$store.commit('SET_CONTACTLIST', resp.contacts);\r\n      this.$Service.log(`拉取联系人列表：：：${JSON.stringify(resp.contacts)}`);\r\n    });\r\n    this.$nextTick(() => {\r\n      const cardBody = document.querySelector('.contacts');\r\n      cardBody.addEventListener('scroll', (e) => {\r\n        e.stopPropagation();\r\n        this.loadMoreData(cardBody);\r\n      })\r\n    });\r\n    // if (this.members_range.hasOwnProperty('contact')) {\r\n      if (this.returnPageValue.hasOwnProperty('contact')) {\r\n    // this.selectedMembers = Object.assign({}, this.members_range.contact);\r\n      this.selectedMembers = Object.assign({}, this.returnPageValue.contact);\r\n      this.$emit('selectMembers', {'contact': this.selectedMembers});\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters([ 'contact_list', 'members_range' ]),\r\n    contactsList() {\r\n      console.log('好友列表:',this.contact_list);\r\n      if (this.searchInfo.trim() === '') {\r\n        return _.orderBy(\r\n          _.filter(this.contact_list, e => e.id && e.isApp == 2 && e.isHidden == 2),\r\n          val => {\r\n            return converseFullPinYin(val.pinyin.trim());\r\n          },\r\n          ['asc']\r\n        );\r\n      }\r\n      return _.filter(this.contact_list, e => e.name.indexOf(this.searchInfo) >= 0);\r\n    }\r\n  },\r\n  methods: {\r\n    // 滑动加载更多\r\n    loadMoreData(el) {\r\n      this.$nextTick(() => {\r\n        if (this.isScrollToBottom(el)){\r\n          if (this.initLength < this.contact_list.length) {\r\n            console.log('加载更多数据');\r\n            if (this.contact_list.length - this.initLength < 10) {\r\n              this.initLength = this.contact_list.length;\r\n              console.log('已展示全部数据');\r\n            } else {\r\n              this.initLength += 10;\r\n              console.log('已增加展示数量');\r\n            }\r\n          }\r\n        }\r\n      })\r\n    },\r\n    selectContact(value) {\r\n      if (this.selectedMembers.hasOwnProperty(value.id)) {\r\n        //如果当前选择的列表中已经有该成员，则删除它\r\n        this.$delete(this.selectedMembers, value.id);\r\n      } else {\r\n        this.$set(this.selectedMembers, value.id, value);\r\n      }\r\n      console.log(\"this.selectedMembers:\", this.selectedMembers);\r\n      let memberObj = {\r\n        'contact': this.selectedMembers\r\n      }\r\n      this.$emit('selectMembers', memberObj);\r\n    },\r\n    isSelected(id) {\r\n      console.log('接受到的人列表',this.returnPageValue.contact)\r\n      if (this.returnPageValue.hasOwnProperty('contact')) {\r\n        let membersKeys = Object.keys(this.returnPageValue.contact);\r\n        console.log('membersKeys',membersKeys);\r\n        return membersKeys.includes(id);\r\n      }\r\n      if(!this.returnPageValue.contact){\r\n        console.log('this.id',id)\r\n        console.log(Object.keys(this.selectedMembers))\r\n        let membersKeys = Object.keys(this.selectedMembers);\r\n        return membersKeys.includes(id);\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.contacts {\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n  &:hover {\r\n    overflow: overlay;\r\n  }\r\n  .contacts-item {\r\n    padding: 15px;\r\n    padding-right: 5px;\r\n    box-sizing: border-box;\r\n    display: flex;\r\n    align-items: center;\r\n    flex: 1;\r\n    .avatar {\r\n      margin-right: 10px;\r\n      flex: 1\r\n    }\r\n    .contacts-name {\r\n      flex: 8;\r\n      font-size: 14px;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n      -o-text-overflow: ellipsis;\r\n      white-space: nowrap;\r\n      display: inline-block;\r\n    }\r\n    .checkbox-right {\r\n      flex: 1;\r\n    }\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=2078d86d&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=2078d86d&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2078d86d\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=2078d86d&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=2078d86d&lang=scss&scoped=true&\""],"sourceRoot":""}